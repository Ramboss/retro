0001   0000             .org 0h
0002   0000             
0003   0000             BUF = 0BA00h
0004   0000             
0005   0000 21 DF 00    go:     lxi h, title
0006   0003 CD 18 F8            call 0F818h
0007   0006             	
0008   0006 21 01 EF            lxi h, 0EF01h
0009   0009 36 80               mvi m, 080h
0010   000B 2D                  dcr l
0011   000C 36 FF               mvi m, 0FFh
0012   000E 36 FF               mvi m, 0FFh
0013   0010             
0014   0010 3E 0A               mvi a, 10
0015   0012 11 9C 04            lxi d, text
0016   0015 F5          go0:	push psw
0017   0016 01 00 BA            lxi b, BUF
0018   0019 CD CA 03            call unmlz
0019   001C D5                  push d
0020   001D CD 2C 00            call show 
0021   0020 D1                  pop d
0022   0021 F1                  pop psw
0023   0022 3D                  dcr a 
0024   0023 C2 15 00            jnz go0
0025   0026             
0026   0026             mme:
0027   0026 CD 7D 01            call doMute
0028   0029 C3 26 00            jmp mme
0029   002C             
0030   002C 21 00 BA    show:   lxi h, BUF
0031   002F             frame:
0032   002F 11 96 E4            lxi d, 0E496h
0033   0032 01 0D 40    	lxi b, 64*256+13
0034   0035             loop:
0035   0035 7E                  mov a, m
0036   0036 23                  inx h
0037   0037 FE 7F               cpi 127
0038   0039 C8                  rz
0039   003A FE 20               cpi 32
0040   003C DA 64 00            jc repe
0041   003F FE 61               cpi 'a'
0042   0041 D2 75 00            jnc spaces
0043   0044 FE 80       l1:     cpi 128
0044   0046 D2 54 00            jnc old
0045   0049 32 D0 00            sta lastChar
0046   004C 12          l2:     stax d
0047   004D 13                  inx d
0048   004E CD 86 00            call eol
0049   0051 C3 35 00            jmp loop
0050   0054             
0051   0054 D6 7E       old:    sui 126
0052   0056 F5          old_l:  push psw
0053   0057 1A                  ldax d
0054   0058 13                  inx d
0055   0059 CD 86 00            call eol
0056   005C F1                  pop psw
0057   005D 3D                  dcr a
0058   005E C2 56 00            jnz old_l
0059   0061 C3 35 00            jmp loop
0060   0064             
0061   0064             repe:
0062   0064 F5          repea:  push psw
0063   0065 3A D0 00            lda lastChar
0064   0068 12                  stax d
0065   0069 13                  inx d
0066   006A CD 86 00            call eol
0067   006D F1                  pop psw
0068   006E 3D                  dcr a
0069   006F C2 64 00            jnz repea
0070   0072 C3 35 00            jmp loop
0071   0075             
0072   0075 FE 7B       spaces: cpi 'z'+1
0073   0077 D2 44 00            jnc l1
0074   007A D6 61               sui 'a'  
0075   007C F5                  push psw
0076   007D 3E 20               mvi a, ' '
0077   007F 32 D0 00            sta lastChar
0078   0082 F1                  pop  psw
0079   0083 C3 64 00            jmp repea        
0080   0086                     
0081   0086 05          eol:    dcr b
0082   0087 C0                  rnz
0083   0088 06 40               mvi b, 64
0084   008A                     
0085   008A E5                  push h
0086   008B EB                  xchg
0087   008C 11 0E 00            lxi d, 14
0088   008F 19                  dad d
0089   0090 EB                  xchg
0090   0091 E1                  pop h
0091   0092             
0092   0092 0D                  dcr c
0093   0093 C0                  rnz
0094   0094 0E 0D               mvi c, 13
0095   0096             
0096   0096 7E                  mov a, m
0097   0097 23                  inx h 
0098   0098                     
0099   0098 C5                  push b
0100   0099 D5                  push d
0101   009A E5                  push h        
0102   009B             frameDivider:
0103   009B 0E 06       	mvi c, 6 ; frameDivider
0104   009D 06 07       y:	mvi b, SPD
0105   009F C5          x:	push b
0106   00A0 CD D2 00    	call waitHorzSync
0107   00A3 C1          	pop b
0108   00A4 05          	dcr b
0109   00A5 C2 9F 00    	jnz x
0110   00A8             
0111   00A8 C5                  push b
0112   00A9 CD 15 01    	call doMusic
0113   00AC CD 7D 01    	call doMute	
0114   00AF C1                  pop b
0115   00B0             	
0116   00B0 0D          	dcr c
0117   00B1 C2 9D 00    	jnz y
0118   00B4             
0119   00B4 E1                  pop h
0120   00B5 D1                  pop d
0121   00B6 C1                  pop b
0122   00B7             
0123   00B7 CD 1B F8            call 0F81Bh
0124   00BA FE 31               cpi '1'
0125   00BC DA C9 00            jc if0
0126   00BF FE 3A               cpi '9'+1
0127   00C1 D2 C9 00            jnc if0
0128   00C4 D6 30               sui '1'-1
0129   00C6 32 9C 00            sta frameDivider+1
0130   00C9             if0:
0131   00C9             	
0132   00C9 11 96 E4            lxi d, 0E496h
0133   00CC 01 0D 40    	lxi b, 64*256+13
0134   00CF C9                  ret
0135   00D0                 
0136   00D0 00          lastChar: .db 0
0137   00D1 00          musicDiver: .db 0
0138   00D2             
0139   00D2             ;----------------------------------------------------------------------------
0140   00D2             
0141   00D2             waitHorzSync:
0142   00D2 21 01 EF    	lxi h, 0EF01h
0143   00D5 36 27       	mvi m, 027h
0144   00D7 7E          	mov a, m
0145   00D8             waitHorzSync_1:
0146   00D8 7E          	mov a, m
0147   00D9 E6 20       	ani 20h
0148   00DB CA D8 00    	jz waitHorzSync_1
0149   00DE C9          	ret
0150   00DF             	
0151   00DF 1F 6B 6C 61 title: .db 01Fh,"klawi{i 1-9 izmenenie skorosti",0
0151   00E3 77 69 7B 69 
0151   00E7 20 31 2D 39 
0151   00EB 20 69 7A 6D 
0151   00EF 65 6E 65 6E 
0151   00F3 69 65 20 73 
0151   00F7 6B 6F 72 6F 
0151   00FB 73 74 69 00 
0152   00FF             
0153   00FF             .include "music.inc"
0001+  00FF             ; (c) 2012 vinxru
0002+  00FF             
0003+  00FF             SPD = 7
0004+  00FF             
0005+  00FF 21 BF 01    initMusic:	lxi h, music
0006+  0102 22 2D 01    		shld musicptr
0007+  0105 21 2F 01    		lxi h, channelInfo
0008+  0108 AF          		xra a
0009+  0109 77          		mov m, a
0010+  010A 23          		inx h
0011+  010B 77          		mov m, a
0012+  010C 23          		inx h
0013+  010D 77          		mov m, a
0014+  010E 23          		inx h
0015+  010F 77          		mov m, a
0016+  0110 23          		inx h
0017+  0111 77          		mov m, a
0018+  0112 23          		inx h
0019+  0113 77          		mov m, a
0020+  0114 C9          		ret
0021+  0115             
0022+  0115 1E 00       doMusic:	mvi e, 0
0023+  0117 21 2F 01    		lxi h, channelInfo
0024+  011A CD 3A 01    		call processChannel
0025+  011D 1E 01                       mvi e, 1
0026+  011F 21 31 01    		lxi h, channelInfo+2
0027+  0122 CD 3A 01    		call processChannel
0028+  0125 1E 02                       mvi e, 2
0029+  0127 21 33 01    		lxi h, channelInfo+4
0030+  012A C3 3A 01    		jmp processChannel		
0031+  012D             
0032+  012D             ;------------------------------------------------------------------
0033+  012D             
0034+  012D BF 01       musicptr:	.dw music
0035+  012F 00 00 00 00 channelInfo:	.db 0,0,0,0,0,0
0035+  0133 00 00 
0036+  0135             
0037+  0135             ;------------------------------------------------------------------
0038+  0135             
0039+  0135             
0040+  0135 E5          restartMelody:  push h
0041+  0136 CD FF 00    		call initMusic
0042+  0139 E1          		pop h
0043+  013A             
0044+  013A             processChannel:	; hl - указатель на channelInfo
0045+  013A             		; e - канал
0046+  013A             
0047+  013A 7E          		mov a, m
0048+  013B B7          		ora a
0049+  013C C2 7B 01    		jnz channelWait
0050+  013F             
0051+  013F                             ; a = *musicptr++
0052+  013F E5          		push h
0053+  0140 2A 2D 01    		lhld musicptr
0054+  0143 7E          		mov a, m
0055+  0144 E1          		pop h
0056+  0145 FE FF       		cpi 0FFh
0057+  0147 C8          		rz
0058+  0148 E5          		push h
0059+  0149 2A 2D 01    		lhld musicptr
0060+  014C 23          		inx h
0061+  014D 22 2D 01    		shld musicptr
0062+  0150 E1          		pop h
0063+  0151             
0064+  0151             		; end of melody
0065+  0151             ;		cpi 0FFh
0066+  0151             ;		jz restartMelody
0067+  0151             
0068+  0151             		; delay
0069+  0151 57          		mov d, a		
0070+  0152 07          		rlc
0071+  0153 07          		rlc
0072+  0154 07          		rlc
0073+  0155 E6 07       		ani 7
0074+  0157 77          		mov m, a		
0075+  0158             
0076+  0158             		; note
0077+  0158 7A          		mov a, d
0078+  0159 E6 1F       		ani 01Fh
0079+  015B             
0080+  015B             		; none
0081+  015B C8          		rz
0082+  015C             
0083+  015C             		; noise
0084+  015C             		;cpi 1
0085+  015C             		;jz noise
0086+  015C             
0087+  015C             		; bc = word_notes[a]
0088+  015C E5          		push h
0089+  015D 6F          		mov l, a
0090+  015E 26 00       		mvi h, 0
0091+  0160 29          		dad h
0092+  0161 01 9D 01    		lxi b, notes
0093+  0164 09          		dad b
0094+  0165 4E          		mov c, m
0095+  0166 23          		inx h
0096+  0167 46          		mov b, m
0097+  0168 E1          		pop h
0098+  0169             		
0099+  0169             		; Длительность звучания
0100+  0169 3E 0C       		mvi a, 12
0101+  016B             
0102+  016B             ;		jmp writeFq
0103+  016B             
0104+  016B             ;------------------------------------------------------------------
0105+  016B             
0106+  016B             ;noise:		; Задержа
0107+  016B             ;		mvi a, 2
0108+  016B             ;
0109+  016B             ;		; Частота
0110+  016B             ;                lxi b, 160
0111+  016B             
0112+  016B             writeFq:	; Задержа
0113+  016B 23                		inx h
0114+  016C 77          		mov m, a
0115+  016D             
0116+  016D             		; Сдвиг
0117+  016D 26 00       		mvi h, 0
0118+  016F 6B          		mov l, e
0119+  0170 29          		dad h
0120+  0171 29          		dad h
0121+  0172 09          		dad b
0122+  0173 44          		mov b, h
0123+  0174 4D          		mov c, l
0124+  0175             
0125+  0175             		; Запись частоты
0126+  0175             ;		mov l, e
0127+  0175             ;		mvi h, 0ECh
0128+  0175             ;		mvi m, 1
0129+  0175             ;		mvi m, 1
0130+  0175             
0131+  0175             		; Запись частоты
0132+  0175 6B          		mov l, e
0133+  0176 26 EC       		mvi h, 0ECh
0134+  0178 71          		mov m, c
0135+  0179 70          		mov m, b
0136+  017A             
0137+  017A C9          		ret
0138+  017B             		
0139+  017B             ;------------------------------------------------------------------
0140+  017B             
0141+  017B 35          channelWait:	dcr m
0142+  017C C9          		ret
0143+  017D             
0144+  017D             ;------------------------------------------------------------------
0145+  017D             
0146+  017D 21 03 EC    doMute:		lxi h, 0EC03h
0147+  0180 11 30 01    		lxi d, channelInfo+1
0148+  0183 06 3E       		mvi b, 3Eh
0149+  0185 CD 8F 01    		call mutex
0150+  0188 06 7E       		mvi b, 40h|3Eh
0151+  018A CD 8F 01    		call mutex
0152+  018D 06 BE       		mvi b, 80h|3Eh
0153+  018F 1A          mutex:		ldax d
0154+  0190 B7          		ora a
0155+  0191 CA 9A 01    		jz l21
0156+  0194 3D          		dcr a
0157+  0195 C2 99 01    		jnz l11
0158+  0198 70          		mov m, b
0159+  0199 12          l11:		stax d
0160+  019A 13          l21:		inx d
0161+  019B 13          		inx d
0162+  019C C9          		ret
0163+  019D             
0164+  019D             ;------------------------------------------------------------------
0165+  019D             
0166+  019D             notes:		
0167+  019D             .include "music_notes.inc";
0001++ 019D               
0002++ 019D 00 00 0A 00  .dw 0,10,6096,2288,4560,3616,3040,3424,4064,2560,4832,6848,5424,3840,2880,2720
0002++ 01A1 D0 17 F0 08 
0002++ 01A5 D0 11 20 0E 
0002++ 01A9 E0 0B 60 0D 
0002++ 01AD E0 0F 00 0A 
0002++ 01B1 E0 12 C0 1A 
0002++ 01B5 30 15 00 0F 
0002++ 01B9 40 0B A0 0A 
0003++ 01BD 00 14        .dw 51200168+  01BF             music:
0169+  01BF             .include "music_data.inc"
0001++ 01BF               
0002++ 01BF E0 E0 E0 60  .db 224,224,224,96,96,96,34,34,34,2,2,2,2,2,2,227
0002++ 01C3 60 60 22 22 
0002++ 01C7 22 02 02 02 
0002++ 01CB 02 02 02 E3 
0003++ 01CF E2 E4 E0 E5  .db 226,228,224,229,230,103,100,39,5,8,227,230,227,96,101,102
0003++ 01D3 E6 67 64 27 
0003++ 01D7 05 08 E3 E6 
0003++ 01DB E3 60 65 66 
0004++ 01DF 67 64 27 05  .db 103,100,39,5,8,227,230,227,96,101,102,105,104,39,5,7
0004++ 01E3 08 E3 E6 E3 
0004++ 01E7 60 65 66 69 
0004++ 01EB 68 27 05 07 
0005++ 01EF E6 EA E8 60  .db 230,234,232,96,66,66,2,2,227,226,228,224,229,230,103,100
0005++ 01F3 42 42 02 02 
0005++ 01F7 E3 E2 E4 E0 
0005++ 01FB E5 E6 67 64 
0006++ 01FF 27 05 08 E3  .db 39,5,8,227,230,227,96,101,102,103,100,39,5,8,227,230
0006++ 0203 E6 E3 60 65 
0006++ 0207 66 67 64 27 
0006++ 020B 05 08 E3 E6 
0007++ 020F E3 60 65 66  .db 227,96,101,102,105,104,39,5,7,230,234,232,96,66,66,2
0007++ 0213 69 68 27 05 
0007++ 0217 07 E6 EA E8 
0007++ 021B 60 42 42 02 
0008++ 021F 02 E7 EB AC  .db 2,231,235,172,44,224,228,39,37,40,36,224,108,36,8,5
0008++ 0223 2C E0 E4 27 
0008++ 0227 25 28 24 E0 
0008++ 022B 6C 24 08 05 
0009++ 022F 48 48 0C 0C  .db 72,72,12,12,230,98,106,66,66,2,2,231,235,172,44,224
0009++ 0233 E6 62 6A 42 
0009++ 0237 42 02 02 E7 
0009++ 023B EB AC 2C E0 
0010++ 023F E4 27 25 28  .db 228,39,37,40,36,109,77,70,8,8,230,234,232,96,66,66
0010++ 0243 24 6D 4D 46 
0010++ 0247 08 08 E6 EA 
0010++ 024B E8 60 42 42 
0011++ 024F 02 02 E7 EB  .db 2,2,231,235,172,44,224,228,39,37,40,36,224,44,36,8
0011++ 0253 AC 2C E0 E4 
0011++ 0257 27 25 28 24 
0011++ 025B E0 2C 24 08 
0012++ 025F 08 05 05 4C  .db 8,5,5,76,72,12,12,230,106,106,70,70,6,6,71,78
0012++ 0263 48 0C 0C E6 
0012++ 0267 6A 6A 46 46 
0012++ 026B 06 06 47 4E 
0013++ 026F 43 04 07 09  .db 67,4,7,9,68,71,79,231,4,6,68,71,13,13,72,72
0013++ 0273 44 47 4F E7 
0013++ 0277 04 06 44 47 
0013++ 027B 0D 0D 48 48 
0014++ 027F 80 84 04 E6  .db 128,132,4,230,106,104,106,104,96,34,34,34,2,2,2,2
0014++ 0283 6A 68 6A 68 
0014++ 0287 60 22 22 22 
0014++ 028B 02 02 02 02 
0015++ 028F 02 02 E3 E2  .db 2,2,227,226,228,224,229,230,103,100,39,5,8,227,230,227
0015++ 0293 E4 E0 E5 E6 
0015++ 0297 67 64 27 05 
0015++ 029B 08 E3 E6 E3 
0016++ 029F 60 65 66 67  .db 96,101,102,103,100,39,5,8,227,230,227,96,101,102,105,104
0016++ 02A3 64 27 05 08 
0016++ 02A7 E3 E6 E3 60 
0016++ 02AB 65 66 69 68 
0017++ 02AF 27 05 07 E6  .db 39,5,7,230,234,232,96,66,66,2,2,227,226,228,224,229
0017++ 02B3 EA E8 60 42 
0017++ 02B7 42 02 02 E3 
0017++ 02BB E2 E4 E0 E5 
0018++ 02BF E6 67 64 27  .db 230,103,100,39,5,8,227,230,227,96,101,102,103,100,39,5
0018++ 02C3 05 08 E3 E6 
0018++ 02C7 E3 60 65 66 
0018++ 02CB 67 64 27 05 
0019++ 02CF 08 E3 E6 E3  .db 8,227,230,227,96,101,102,105,104,39,5,7,230,234,232,96
0019++ 02D3 60 65 66 69 
0019++ 02D7 68 27 05 07 
0019++ 02DB E6 EA E8 60 
0020++ 02DF 42 42 02 02  .db 66,66,2,2,231,235,172,44,224,228,39,37,40,36,224,108
0020++ 02E3 E7 EB AC 2C 
0020++ 02E7 E0 E4 27 25 
0020++ 02EB 28 24 E0 6C 
0021++ 02EF 24 08 05 48  .db 36,8,5,72,72,12,12,230,98,106,66,66,2,2,231,235
0021++ 02F3 48 0C 0C E6 
0021++ 02F7 62 6A 42 42 
0021++ 02FB 02 02 E7 EB 
0022++ 02FF AC 2C E0 E4  .db 172,44,224,228,39,37,40,36,105,104,39,5,7,230,234,232
0022++ 0303 27 25 28 24 
0022++ 0307 69 68 27 05 
0022++ 030B 07 E6 EA E8 
0023++ 030F 60 42 42 02  .db 96,66,66,2,2,231,235,172,44,224,228,39,37,40,36,224
0023++ 0313 02 E7 EB AC 
0023++ 0317 2C E0 E4 27 
0023++ 031B 25 28 24 E0 
0024++ 031F 6C 24 08 05  .db 108,36,8,5,72,72,12,12,230,98,106,66,66,2,2,231
0024++ 0323 48 48 0C 0C 
0024++ 0327 E6 62 6A 42 
0024++ 032B 42 02 02 E7 
0025++ 032F EB AC 2C E0  .db 235,172,44,224,228,39,37,40,36,109,77,70,8,8,230,234
0025++ 0333 E4 27 25 28 
0025++ 0337 24 6D 4D 46 
0025++ 033B 08 08 E6 EA 
0026++ 033F E8 60 42 42  .db 232,96,66,66,2,2,231,235,172,44,224,228,39,37,40,36
0026++ 0343 02 02 E7 EB 
0026++ 0347 AC 2C E0 E4 
0026++ 034B 27 25 28 24 
0027++ 034F E0 2C 24 08  .db 224,44,36,8,8,5,5,76,72,12,12,230,106,106,70,70
0027++ 0353 08 05 05 4C 
0027++ 0357 48 0C 0C E6 
0027++ 035B 6A 6A 46 46 
0028++ 035F 06 06 47 4E  .db 6,6,71,78,67,4,7,9,68,71,79,231,4,6,68,71
0028++ 0363 43 04 07 09 
0028++ 0367 44 47 4F E7 
0028++ 036B 04 06 44 47 
0029++ 036F 0D 0D 48 48  .db 13,13,72,72,128,132,4,230,106,104,106,104,96,34,34,34
0029++ 0373 80 84 04 E6 
0029++ 0377 6A 68 6A 68 
0029++ 037B 60 22 22 22 
0030++ 037F 02 02 02 02  .db 2,2,2,2,2,2,227,226,228,224,229,230,103,100,39,5
0030++ 0383 02 02 E3 E2 
0030++ 0387 E4 E0 E5 E6 
0030++ 038B 67 64 27 05 
0031++ 038F 08 E3 E6 E3  .db 8,227,230,227,96,101,102,103,100,39,5,8,227,230,227,96
0031++ 0393 60 65 66 67 
0031++ 0397 64 27 05 08 
0031++ 039B E3 E6 E3 60 
0032++ 039F 65 66 30 68  .db 101,102,48,104,39,5,5,7,7,226,234,232,98,98,102,229
0032++ 03A3 27 05 05 07 
0032++ 03A7 07 E2 EA E8 
0032++ 03AB 62 62 66 E5 
0033++ 03AF E6 E3 E0 E0  .db 230,227,224,224,224,224,224,224,96,96,96,37,38,35,5,6
0033++ 03B3 E0 E0 E0 E0 
0033++ 03B7 60 60 60 25 
0033++ 03BB 26 23 05 06 
0034++ 03BF 03 05 06 03  .db 3,5,6,3,229,230,227,224,224,224,2550034++ 03C3 E5 E6 E3 E0 
0034++ 03C7 E0 E0 FF 
0154   03CA             .include "unmlz.inc"
0001+  03CA             unmlz:		;push	b
0002+  03CA 3E 80       		mvi	a, 80h
0003+  03CC             UNLD:
0004+  03CC 32 9B 04    		sta	unmlz_1
0005+  03CF 1A          		ldax	d
0006+  03D0 13          		inx	d
0007+  03D1 C3 DD 03    		jmp	UNSTA
0008+  03D4             ; ---------------------------------------------------------------------------
0009+  03D4 7E          UNST3:		mov	a, m
0010+  03D5 23          		inx	h
0011+  03D6 02          		stax	b
0012+  03D7 03          		inx	b
0013+  03D8             		
0014+  03D8 7E          UNST2:		mov	a, m
0015+  03D9 23          		inx	h
0016+  03DA 02          		stax	b
0017+  03DB 03          		inx	b
0018+  03DC             
0019+  03DC 7E          UNST1:		mov	a, m
0020+  03DD             
0021+  03DD 02          UNSTA:		stax	b
0022+  03DE 03          		inx	b
0023+  03DF             
0024+  03DF 3A 9B 04    ULOOP:		lda	unmlz_1
0025+  03E2 87          		add	a
0026+  03E3 C2 E9 03    		jnz	L1
0027+  03E6 1A          		ldax	d
0028+  03E7 13          		inx	d
0029+  03E8 17          		ral
0030+  03E9             
0031+  03E9 DA CC 03    L1:		jc	UNLD
0032+  03EC 87          		add	a
0033+  03ED C2 F3 03    		jnz	L3
0034+  03F0 1A          		ldax	d
0035+  03F1 13          		inx	d
0036+  03F2 17          		ral
0037+  03F3             
0038+  03F3 DA 19 04    L3:		jc	UN2
0039+  03F6 87          		add	a
0040+  03F7 C2 FD 03    		jnz	L2
0041+  03FA 1A          		ldax	d
0042+  03FB 13          		inx	d
0043+  03FC 17          		ral
0044+  03FD             
0045+  03FD DA 0D 04    L2:		jc	UN1
0046+  0400 21 FF 3F    		lxi	h, 3FFFh
0047+  0403 CD 64 04    		call	GETBITS
0048+  0406 32 9B 04    		sta	unmlz_1
0049+  0409 09          		dad	b
0050+  040A C3 DC 03    		jmp	UNST1
0051+  040D             
0052+  040D             ; ---------------------------------------------------------------------------
0053+  040D             
0054+  040D 32 9B 04    UN1:		sta	unmlz_1
0055+  0410 1A          		ldax	d
0056+  0411 13          		inx	d
0057+  0412 6F          		mov	l, a
0058+  0413 26 FF       		mvi	h, 0FFh
0059+  0415 09          		dad	b
0060+  0416 C3 D8 03    		jmp	UNST2
0061+  0419             
0062+  0419             ; ---------------------------------------------------------------------------
0063+  0419             
0064+  0419 87          UN2:		add	a
0065+  041A C2 20 04    		jnz	L4
0066+  041D 1A          		ldax	d
0067+  041E 13          		inx	d
0068+  041F 17          		ral
0069+  0420             
0070+  0420 DA 2A 04    L4:		jc	UN3
0071+  0423 CD 79 04    		call	GETBIGD
0072+  0426 09          		dad	b
0073+  0427 C3 D4 03    		jmp	UNST3
0074+  042A             
0075+  042A             ; ---------------------------------------------------------------------------
0076+  042A             
0077+  042A 26 00       UN3:		mvi	h, 0
0078+  042C             
0079+  042C 24          UN3A:		inr	h
0080+  042D 87          		add	a
0081+  042E C2 34 04    		jnz	L5
0082+  0431 1A          		ldax	d
0083+  0432 13          		inx	d
0084+  0433 17          		ral
0085+  0434             
0086+  0434 D2 2C 04    L5:		jnc	UN3A
0087+  0437 F5          		push	psw
0088+  0438 7C          		mov	a, h
0089+  0439 FE 08       		cpi	8
0090+  043B D2 62 04    		jnc	UNEXIT
0091+  043E 3E 00       		mvi	a, 0
0092+  0440             
0093+  0440 1F          L5B:		rar
0094+  0441 25          		dcr	h
0095+  0442 C2 40 04    		jnz	L5B
0096+  0445 67          		mov	h, a
0097+  0446 2E 01       		mvi	l, 1
0098+  0448 F1          		pop	psw
0099+  0449 CD 64 04    		call	GETBITS
0100+  044C 23          		inx	h
0101+  044D 23          		inx	h
0102+  044E E5          		push	h
0103+  044F CD 79 04    		call	GETBIGD
0104+  0452 EB          		xchg
0105+  0453 E3          		xthl
0106+  0454 EB          		xchg
0107+  0455 09          		dad	b
0108+  0456             
0109+  0456 7E          LDIR:		mov	a, m
0110+  0457 23          		inx	h
0111+  0458 02          		stax	b
0112+  0459 03          		inx	b
0113+  045A 1D          		dcr	e
0114+  045B C2 56 04    		jnz	LDIR
0115+  045E D1          		pop	d
0116+  045F C3 DF 03    		jmp	ULOOP
0117+  0462             
0118+  0462             ; ---------------------------------------------------------------------------
0119+  0462             
0120+  0462 F1          UNEXIT:		pop	psw
0121+  0463             		;pop	b
0122+  0463 C9          		ret
0123+  0464             
0124+  0464             ; ===========================================================================
0125+  0464             
0126+  0464 87          GETBITS:	add	a
0127+  0465 C2 6B 04    		jnz	L7
0128+  0468 1A          		ldax	d
0129+  0469 13          		inx	d
0130+  046A 17          		ral		
0131+  046B DA 73 04    L7:		jc	GETB1
0132+  046E 29          		dad	h
0133+  046F D8          		rc
0134+  0470 C3 64 04    		jmp	GETBITS
0135+  0473             
0136+  0473             ; ---------------------------------------------------------------------------
0137+  0473             
0138+  0473 29          GETB1:		dad	h
0139+  0474 2C          		inr	l
0140+  0475 D8          		rc
0141+  0476 C3 64 04    		jmp	GETBITS
0142+  0479             
0143+  0479             ; ===========================================================================
0144+  0479             
0145+  0479 87          GETBIGD:	add	a
0146+  047A C2 80 04    		jnz	L8
0147+  047D 1A          		ldax	d
0148+  047E 13          		inx	d
0149+  047F 17          		ral
0150+  0480             
0151+  0480 DA 8C 04    L8:		jc	GETBD1
0152+  0483 32 9B 04    		sta	unmlz_1
0153+  0486 1A          		ldax	d
0154+  0487 13          		inx	d
0155+  0488 6F          		mov	l, a
0156+  0489 26 FF       		mvi	h, 0FFh
0157+  048B C9          		ret
0158+  048C             
0159+  048C             ; ---------------------------------------------------------------------------
0160+  048C             
0161+  048C 21 FF 1F    GETBD1:		lxi	h, 1FFFh
0162+  048F CD 64 04    		call	GETBITS
0163+  0492 32 9B 04    		sta	unmlz_1
0164+  0495 65          		mov	h, l
0165+  0496 25          		dcr	h
0166+  0497 1A          		ldax	d
0167+  0498 13          		inx	d
0168+  0499 6F          		mov	l, a
0169+  049A C9          		ret
0170+  049B             
0171+  049B 00          unmlz_1: .db 00155   049C             
0156   049C             text:
0157   049C             .endtasm: Number of errors = 0
